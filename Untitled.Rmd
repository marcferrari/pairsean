---
title: "Module 4 Pair Quiz"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
#### Ayuson, Marc Edison
#### See, Sean Jacob
#### 7/29/21

## Questions {.tabset .tabfade}

### Question 1

**1. An article in the Journal of Sound and Vibration ["Measurement of Noise-Evoked Blood Pressure by Means of Averaging Method: Relation between Blood Pressure Rise and PSL" (1991, Vol. 151(3), pp. 383-394)] described a study investigating the relationship between noise exposure and hypertension. The following data are representative of those reported in the article.**

---

#### A. Draw a scatter diagram of y (blood pressure rise in millimeters of mercury) versus x (sound pressure level in decibels). Does a simple linear regression model seem reasonable in this situation?

```{r}
y <- c(1, 0, 1, 2, 5, 1, 4, 6, 2, 3, 5, 4, 6, 8, 4, 5, 7, 9, 7, 6)
x <- c(60,	63,	65,	70,	70,	70,	80,	90,	80,	80,	85,	89,	90,	90,	90,	90,	94,	100,	100,	100)
table<-data.frame(y,x)
knitr::kable(table,"pipe",col.name=c("Blood Pressure Rise in milimeters of Mercury (mmHg)", "Sound Pressure Level in Decibels(dB)"), align=c("c","c"))
```

```{r}
y <- c(1, 0, 1, 2, 5, 1, 4, 6, 2, 3, 5, 4, 6, 8, 4, 5, 7, 9, 7, 6)
x <- c(60,	63,	65,	70,	70,	70,	80,	90,	80,	80,	85,	89,	90,	90,	90,	90,	94,	100,	100,	100)
plot(x, y, pch=16, cex=1, main = "Sound Pressure Level(dB) vs Blood Pressure Rise(mmHg)" ,xlab = "Sound Pressure Level in Decibels (dB)", ylab= "Blood Pressure Rise in Millimeters of Mercury (mmHg)")
lm(y ~ x)
abline(lm(y ~ x), col = "blue")
```

Based on the graph shown above, **a linear regression model would be reasonable** as there is a linear relationship between the given variables. There is a trend that shows that as one variable increases, the other variable also increases.

---

#### B. Fit the simple linear regression model using least squares. Find an estimate of $\sigma^2$.

```{r}
fit <- lm(y ~ x)
```

We can find the estimate through the formula:

<center>

$\sigma^2 = \frac {SSE}{n-2}$

</center>

wherein n = 20 and,

The formula for the SSE is as follows:

<center>

$\sum_{i=1}^n (y_i-\hat y_i)^2$

</center>

This would give us the value for SSE below:

```{r}
SSE <- sum((fitted(fit) - y)^2)
SSE
```

We can now plug it in the first equation which gives us:

<center>

$\sigma^2 = \frac {31.26647}{20-2}$

$\sigma^2 = \frac {31.26647}{18}$

$\sigma^2 = 1.737026$

</center>

This would give us an **estimated value of $\sigma^2$ as 1.737026**.

#### Rechecking:

```{r}
summary(fit)
```

Shown above is the summary of the fit variable wherein the variable is comprised of the lm function of y and x. With this, **we can also find an estimate of $\sigma^2$ through getting the square of the residual standard error**. This is shown by the code below.

<br>

```{r}
(summary(fit)$sigma)**2 
```

This would give us an **estimated value of 1.737026 for $\sigma^2$**.

---

#### C. Find the predicted mean rise in blood pressure level associated with a sound pressure level of 85 decibels.

The formula for the a simple regression line would be as follows:

<center>

$\hat y = \hat \beta_0 + \hat \beta_1x$

</center>

With this in mind, we can find $\hat \beta_0$ and $\hat \beta_1$ through these steps. 

```{r}
Sumxy = sum((x - mean(x)) * (y - mean(y)))
Sumx2= sum((x - mean(x)) ^ 2)
Sumy2 = sum((y - mean(y)) ^ 2)
c(Sumxy, Sumx2, Sumy2)
```

Through these values, we can already find the values for our first equation.

```{r}
beta1 = Sumxy / Sumx2
beta0 = mean(y) - beta1 * mean(x)
c(beta0, beta1)
```

This gives us the equation:

<center>

$\hat y = -10.1315377 + 0.1742939x$

</center>

This would be our simple linear regression model wherein we can plug the value of which is 85.

<center>

$\hat y = -10.1315377 + 0.1742939(85)$

$\hat y = -10.1315377 + 14.8149815$

$\hat y = 4.6834438$

</center>

Our answer would be 4.6834438 or approximately 5. This would show that our **predicted mean rise in blood pressure level associated with a sound pressure level is 5 mmHg**.

### Question 2

**An article in Optical Engineering ["Operating Curve Extraction of a Correlator's Filter" (2004, Vol. 43, pp. 2775-2779)] reported on the use of an optical correlator to perform an experiment by varying brightness and contrast. The resulting modulation is characterized by the useful range of gray levels.**

```{r}

B <-	c(54, 61,	65,	100, 100,	100, 50, 57, 54)
C <- c(56, 80, 70, 50, 65, 80, 25, 35, 26)
Ur <- c(96, 50, 50,	112, 96, 80, 155, 144, 255)

lm(Ur ~ B + C)
```
